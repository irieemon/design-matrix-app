/* ===== CRITICAL MATRIX SLIDING FIX ===== */
/* Direct fix to prevent matrix from sliding horizontally when sidebar toggles */

/* Force all matrix-related containers to stay in place */
.enterprise-matrix-workspace,
.matrix-workspace-layout,
.enterprise-matrix-canvas,
.matrix-container,
.matrix-canvas,
.dnd-context-container {
  /* Critical: Force static positioning to prevent sliding */
  position: static !important;
  left: auto !important;
  right: auto !important;
  transform: none !important;
  margin-left: 0 !important;
  margin-right: 0 !important;

  /* Ensure width adapts to container without horizontal movement */
  width: 100% !important;
  max-width: none !important;

  /* Prevent any transitions that could cause sliding */
  transition: none !important;
}

/* Ensure the main content area within CSS Grid behaves correctly */
.app-layout-grid__main {
  /* Force grid positioning */
  position: static !important;
  left: auto !important;
  transform: none !important;

  /* Ensure content fills grid area without sliding */
  width: 100% !important;
  min-width: 0 !important;

  /* No horizontal margins that could cause positioning issues */
  margin-left: 0 !important;
  margin-right: 0 !important;
}

/* Override any absolute positioning that might be applied */
/* CRITICAL: Do NOT use wildcard * here as it breaks modals! */
/* Instead, target specific matrix elements that need static positioning */
.enterprise-matrix-workspace > .matrix-content,
.enterprise-matrix-workspace > .matrix-grid,
.enterprise-matrix-workspace .matrix-quadrant {
  /* Reset any absolute positioning in direct matrix children only */
  position: static !important;
  left: auto !important;
  transform: none !important;
}

/* Special handling for drag overlay - should not affect main positioning */
.dnd-context-container > *:not([data-overlay]) {
  position: static !important;
  left: auto !important;
  transform: none !important;
}

/* Ensure CSS Grid transition works smoothly without affecting content positioning */
.app-layout-grid {
  /* Only grid-template-columns should transition, nothing else */
  transition: grid-template-columns 250ms cubic-bezier(0.4, 0.0, 0.2, 1) !important;
}

/* Reset any margins or positioning that could interfere with grid layout */
/* EXCLUDE modals from this rule - they need fixed positioning */
.app-layout-grid > *:not(.lux-modal-backdrop):not(.modal-overlay-container):not([class*="fixed"]) {
  margin: 0 !important;
  position: static !important;
}

/* Specific fix for matrix containers nested within the grid */
.app-layout-grid .enterprise-matrix-workspace {
  /* Ensure the workspace fills the grid area completely */
  height: 100vh !important;
  width: 100% !important;
  position: static !important;
  left: auto !important;
  transform: none !important;
}

/* Critical: Prevent any transforms on sidebar state changes */
.sidebar-collapsed .enterprise-matrix-workspace,
.sidebar-expanded .enterprise-matrix-workspace {
  position: static !important;
  left: auto !important;
  transform: none !important;
  margin-left: 0 !important;
}

/* Ensure matrix content adapts to width changes without sliding */
.enterprise-matrix-canvas {
  /* Let flexbox handle the layout, no positioning overrides */
  position: static !important;
  left: auto !important;
  transform: none !important;
  width: 100% !important;
  height: 100% !important;
}

/* CRITICAL FIX: Modal containers need their own explicit positioning
   DO NOT use `revert` as it breaks flexbox centering.
   Instead, let the modal component control its own styles. */
.modal-overlay-container {
  /* Modal overlay needs fixed positioning to cover viewport */
  position: fixed !important;
  inset: 0 !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
}

/* Modal content should be relatively positioned within the flex container */
.modal-overlay-container > div:not([class*="absolute"]):not([class*="backdrop"]) {
  position: relative !important;
}

/* Override any JavaScript-applied styles that might cause sliding - ONLY within matrix containers */
.enterprise-matrix-workspace [style*="left:"],
.matrix-workspace-layout [style*="left:"],
.enterprise-matrix-canvas [style*="left:"],
.matrix-container [style*="left:"],
.matrix-canvas [style*="left:"],
.dnd-context-container [style*="left:"],
.enterprise-matrix-workspace [style*="transform:"],
.matrix-workspace-layout [style*="transform:"],
.enterprise-matrix-canvas [style*="transform:"],
.matrix-container [style*="transform:"],
.matrix-canvas [style*="transform:"],
.dnd-context-container [style*="transform:"],
.enterprise-matrix-workspace [style*="position: absolute"],
.matrix-workspace-layout [style*="position: absolute"],
.enterprise-matrix-canvas [style*="position: absolute"],
.matrix-container [style*="position: absolute"],
.matrix-canvas [style*="position: absolute"],
.dnd-context-container [style*="position: absolute"] {
  position: static !important;
  left: auto !important;
  transform: none !important;
}

/* ============================================
   MODAL CENTERING - HIGHEST PRIORITY OVERRIDES
   These rules MUST come last to override everything above
   ============================================ */

/* Force ALL modal backdrops to use fixed centering - regardless of ancestors */
.lux-modal-backdrop,
div.lux-modal-backdrop,
.fixed.lux-modal-backdrop {
  position: fixed !important;
  inset: 0 !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  z-index: 9999 !important;
}

/* Force modal content to be relatively positioned for flexbox centering */
.lux-modal-backdrop > .lux-modal,
.lux-modal-backdrop > div:first-child:not(.absolute) {
  position: relative !important;
  left: auto !important;
  top: auto !important;
  transform: none !important;
  margin: auto !important;
}

/* Ensure modal-overlay-container also centers properly */
div.modal-overlay-container,
.modal-overlay-container {
  position: fixed !important;
  inset: 0 !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  z-index: 9999 !important;
}

/* Any element with fixed + inset-0 + flex should center its children */
.fixed.inset-0.flex {
  position: fixed !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
}